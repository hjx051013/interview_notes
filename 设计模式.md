# 设计模式


## 面向对象

**1. 什么是面向对象编程**

面向对象编程是一种编程范式或编程风格。它以类或对象作为组织代码的基本单元，并将封装、抽象、继承、多态四个特性，作为代码设计和实现的基石 。


**2. 如何判定一个编程语言是否是面向对象编程语言**
- 严格定义，有现成的语法支持类、对象、四大特性才能叫作面向对象编程语言。
- 广义上来说，只要某种编程语言支持类、对象语法机制，那基本上就可以说这种编程语言是面向对象编程语言了

**3. 面向对象四大特性**
- 封装(Encapsulation)。
    - 定义：封装也叫作信息隐藏或者数据访问保护。
    - 实现：类通过暴露有限的访问接口，授权外部仅能通过类提供的方式（或者叫函数）来访问内部信息或者数据。由编程语言的访问权限控制机制支持(如Java的private, protected, public)。
    - 意义：封装提高了类的易用性，减少了使用者的负担

- 抽象(Abstraction)。
    - 定义：隐藏方法的具体实现，开发者只需关心方法提供了哪些功能。如Java的interface 关键字和abstract 关键字。
    - 实现：
        - 只提供接口，不暴露实现，降低使用者负担
        - 如基于接口而非实现编程、开闭原则（对扩展开放、对修改关闭）、代码解耦（降低代码的耦合性）等编程原则也体现了这一思想。

- 继承(Inheritance)。
    - 定义：继承是用来表示类之间的 is-a 关系
    - 实现：Java使用extends关键字，C++使用冒号，Python使用()，Ruby使用<。Java、PHP、C#、Ruby只支持单继承，C++、Python、Perl支持多重继承。
    - 意义：可实现代码复用，两个类有一些相同的属性和方法，我们就可以将这些相同的部分，抽取到父类中，让两个子类继承父类。但过度继承导致代码可读性变差。

- 多态(Polymorphism)
    - 定义：多态是指父类变量实际上是子类实例，在实际的代码运行过程中，调用子类的方法实现
    - 实现：需要编程语言的三种语法机制
        - 编程语言支持父类对象可以引用子类对象
        - 编程语言支持继承
        - 编程语言支持子类重写父类方法
    - 意义：提高了代码的可扩展性和复用性。

**4. 面向对象比面向过程有哪些优势**
- 对于大规模复杂程序的开发，程序的处理流程并非单一的一条主线，而是错综复杂的网状结构。面向对象编程比起面向过程编程，更能应对这种复杂类型的程序开发。
- 面向对象编程相比面向过程编程，具有更加丰富的特性（封装、抽象、继承、多态）。利用这些特性编写出来的代码，更加易扩展、易复用、易维护。
- 面向对象编程语言比起面向过程编程语言，更加人性化、更加高级、更加智能。

**5. Java中抽象类和接口有啥区别？用途是什么？为啥都存在？**
- 定义与特性。
    - 抽象类。是不允许被实例化的类。抽象类可以包含属性和方法(有具体实现的为具体方法，无具体实现的为抽象方法)。子类继承抽象类必须重写抽象类的所有抽象方法。
    - 接口。不能包含属性。只能声明方法，方法不能包含代码实现。类实现接口的时候，必须实现接口中声明的所有方法。
- 解决的问题。
    - 抽象类。抽象类解决了非具体父类在实现多态时不得不实现一个空的方法的问题。也通过编译器保证了子类一定会实现抽象类的抽象方法。
    - 接口。便于解耦。接口是对行为的一种抽象，将约定和实现分离，提高代码可扩展性。
- 使用时机
    - 如果是is-a关系，使用抽象类，如果是has-a关系，使用接口。

**6. 如何看基于接口而非实现编程和多用组合少用继承**
- 基于接口而非实现编程
    - 做软件开发时，一定要有抽象意识、封装意识、接口意识。越抽象、越顶层、越脱离具体某一实现的设计，越能提高代码的灵活性、扩展性、可维护性。
- 多用组合少用继承
    - 继承主要有三个作用is-a, 支持多态特性，代码复用，这三个作用可以通过组合、接口和委托实现。

**7. 设计原则有哪些？是什么含义？有哪些用途**
- SOLID原则
    - 单一职责原则(SRP, Singleton Responsiblitiy Principle)。一个类只负责完成一个职责或者功能。目的是为了实现代码高内聚、低耦合，提高代码的复用性、可读性、可维护性。
    - 对扩展开放、修改关闭(OCP,Open Closed Principle)。添加一个新的功能应该是，在已有代码基础上扩展代码（新增模块、类、方法等），而非修改已有代码（修改模块、类、方法等）。常用的来提高代码扩展性的方法有：多态、依赖注入、基于接口而非实现编程，以及大部分的设计模式（如装饰、策略、模板、职责链、状态）
    - 里式替换原则(LSP，Liskov Substitution Principle)。子类对象能够替换程序中父类对象出现的任何地方，同时保证原来程序的逻辑行为及正确性不被破坏。用父类的单元测试去测试子类，如果测试运行失败，则说明子类有可能违背里氏替换原则。以下是违反里式替换原则的例子。
        - 子类违背父类声明要实现的功能。
        - 子类违背父类对输入、输出、异常的约定
        - 子类违背父类注释中所罗列的任何特殊说明。
    - 接口隔离原则(Interface Segregation Principle，ISP)。
        - 如何理解？**理解为一组接口集合**: 如果部分接口只被部分调用者使用，我们就需要将这部分接口隔离出来，单独给这部分调用者使用，而不强迫其他调用者也依赖这部分不会被用到的接口。**理解为单个 API 接口或函数**：部分调用者只需要函数中的部分功能，那我们就需要把函数拆分成粒度更细的多个函数，让调用者只依赖它需要的那个细粒度函数。**如果把“接口”理解为 OOP 中的接口**：那接口的设计要尽量单一，不要让接口的实现类和调用者，依赖不需要的接口函数。
    - 依赖倒置原则(Dependency Inversion Principle，DIP)。
        - 高层模块不应该依赖于低层模块，二者都应该依赖于抽象;抽象不应该依赖于细节，细节应该依赖于抽象。如Servlet 规范不依赖具体的 Tomcat 容器和应用程序的实现细节，而 Tomcat 容器和应用程序依赖 Servlet 规范。
- KISS原则(Keep It Simple and Stupid)
    - 保持代码的简单，从而保证可维护性和可读性
    - 如何让代码满足KISS原则
        - 不要使用同事可能不懂的技术来实现代码
        - 不要重复造轮子，要善于使用已经有的工具类库
        - 不过度优化，导致代码可读性降低
- YANGI原则（You Ain’t Gonna Need It）
    - 不编写，不引入当前不需使用的代码
- DRY原则(Don’t Repeat Yourself)
    - 不写重复代码。如何提高代码可复用性
        - 减少代码耦合。
        - 满足单一职责原则。越细粒度的代码，代码的通用性会越好，越容易被复用。
        - 模块化。不单单指一组类构成的模块，还可以理解为单个类、函数
        - 业务与非业务逻辑分离。
        - 通用代码下沉。只允许上层代码调用下层代码，杜绝下层代码调用上层代码。
        - 继承、多态、抽象、封装。
        - 应用模板等设计模式。模板模式利用了多态来实现，可以灵活地替换其中的部分代码，整个流程模板代码可复用。
- 迪米特法则(Law of Demeter, LOD)
    - 高内聚、低耦合的设计思想。高内聚是指相近的功能应该放到同一个类中，不相近的功能不要放到同一个类中。类与类之间的依赖关系简单清晰。即使两个类有依赖关系，一个类的代码改动不会或者很少导致依赖类的代码改动。
    - 不该有直接依赖关系的类之间，不要有依赖；有依赖关系的类之间，尽量只依赖必要的接口


## 快速改善代码质量的20条编程规范
- 命名
    - 命名长度以准确达意味标准
    - 利用上下文简化命名。比如类中变量命名不需要再有与类名相近的前缀
    - 命名要可读、可搜索。不要用生僻、难发音的英文单词来命名
    - 如何命名接口和抽象类
        - Interface加I前缀，对应类为UserService
        - Interface不加前缀，对应的实现类加后缀“Impl”
        - 抽象类，可以加前缀Abstract，也可以不带
        - 项目中命名规则统一
- 注释
    - 命名多数时候应当能够体现代码意义，注释在特别复杂的类或者函数才有必要
    - 面向离职写注释。
- 代码风格
    - 函数、类多大才合适？
        - 函数的代码行数不要超过一屏幕的大小，比如 50 行。类的大小限制比较难确定。
    - 一行代码多长最合适？
        - 一行代码最长不能超过 IDE 显示的宽度
    - 善用空行分割单元块
        - 空行分割不同逻辑块
    - 四格缩进还是两格缩进？
        - 项目内内部统一
    - 大括号是否要另起一行？
        - 不起一行，节省代码行数
    - 类中成员的排列顺序
        - 在 Google Java 编程规范中，依赖类按照字母序从小到大排列。类中先写成员变量后写函数。成员变量之间或函数之间，先写静态成员变量或函数，后写普通变量或函数，并且按照作用域大小依次排列。
- 编码技巧
    -将复杂的逻辑提炼拆分成函数和类。
    - 通过拆分成多个函数或将参数封装为对象的方式，来处理参数过多的情况。
    - 函数中不要使用参数来做代码执行逻辑的控制，直接在调用函数处判断。
    - 函数设计要职责单一。
    - 移除过深的嵌套层次，方法包括：去掉多余的 if 或 else 语句，使用 continue、break、return 关键字提前退出嵌套，调整执行顺序来减少嵌套，将部分嵌套逻辑抽象成函数。
    - 用字面常量取代魔法数。
    - 用解释性变量来解释复杂表达式，以此提高代码可读性。

## 设计模式
口诀为
> 原来的建设工人单独抽奖。<br>带上适当的装备组合可以让外国侨胞享受游戏。<br>多次命令和责备中，车模见状慌忙解开衣服
### 创建型
- ~~单例模式~~
- ~~原型模式~~
- ~~建造者模式~~
- ~~工厂方法模式(简单工厂模式)~~
- ~~抽象工厂模式~~
### 结构型
- ~~代理模式~~
- ~~适配器模式~~
- ~~装饰器模式~~
- 外观模式
- 桥接模式
- 组合模式
- 享元模式
### 行为型
- 迭代器模式
- 命令模式
- 责任链模式
- 备忘录模式
- 中介模式
- 策略模式
- 模板模式
- 观察者模式
- 状态模式
- 访问者模式
- 解释器模式

